<header class="site-header">
  <div class="container">
    <div class="header-inner">
      <a href="{{ '/' | url }}" class="logo">
        <img src="{{ '/assets/images/logo.png' | url }}" alt="{{ navigation.logoAlt }}" class="logo-image">
      </a>

      <button class="mobile-menu-toggle" aria-label="{{ navigation.mobileMenuLabel }}" aria-expanded="false">
        <span class="hamburger"></span>
      </button>

      <nav class="main-nav" id="main-nav">
        <ul>
          {% for item in navigation.mainMenu %}
          {% if item.hasDropdown %}
          <li class="has-dropdown">
            {# Check if any dropdown item is active #}
            {% set isDropdownActive = false %}
            {% for subItem in item.dropdown %}
              {% if page.url | startsWith(subItem.matchUrl) %}
                {% set isDropdownActive = true %}
              {% endif %}
            {% endfor %}
            <a href="#" class="dropdown-toggle{% if isDropdownActive %} active{% endif %}">{{ item.text }}</a>
            <ul class="dropdown-menu">
              {% for subItem in item.dropdown %}
              <li><a href="{{ subItem.url | url }}" {% if page.url | startsWith(subItem.matchUrl) %}class="active"{% endif %}>{{ subItem.text }}</a></li>
              {% endfor %}
            </ul>
          </li>
          {% else %}
          {# Special case for homepage - exact match only #}
          {% if item.matchUrl == "/" %}
          <li><a href="{{ item.url | url }}" {% if page.url == "/" %}class="active"{% endif %}>{{ item.text }}</a></li>
          {% else %}
          <li><a href="{{ item.url | url }}" {% if page.url | startsWith(item.matchUrl) %}class="active"{% endif %}>{{ item.text }}</a></li>
          {% endif %}
          {% endif %}
          {% endfor %}
        </ul>
      </nav>
    </div>
  </div>
</header>
